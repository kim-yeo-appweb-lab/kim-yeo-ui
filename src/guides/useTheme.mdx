import { Meta, Source } from "@storybook/addon-docs/blocks";

<Meta title="Guides/useTheme" />

# useTheme — 테마 관리 Hook

`ThemeProvider`와 `useTheme`을 사용하여 라이트/다크/시스템 테마를 관리합니다.
`data-theme` 속성과 `colorScheme`을 자동으로 설정하며, `localStorage`에 사용자 선택을 저장합니다.

---

## 설치 및 설정

### 1. 스타일 Import

앱의 루트에서 디자인 토큰 CSS를 먼저 로드합니다.

<Source
	language="tsx"
	code={`// app/layout.tsx 또는 main.tsx
import "@kim-yeo/ui/styles";`}
/>

### 2. ThemeProvider 감싸기

앱의 최상위에 `ThemeProvider`를 배치합니다.

<Source
	language="tsx"
	code={`import { ThemeProvider } from "@kim-yeo/ui";

function App() {
return (

<ThemeProvider>
<YourApp />
</ThemeProvider>
);
}`}
/>

---

## useTheme 사용법

`ThemeProvider` 내부의 컴포넌트에서 현재 테마를 읽거나 변경할 수 있습니다.

<Source
	language="tsx"
	code={`import { useTheme } from "@kim-yeo/ui";

function ThemeSwitcher() {
const { theme, setTheme } = useTheme();

    return (
    	<div>
    		<p>현재 테마: {theme}</p>
    		<button onClick={() => setTheme("light")}>라이트</button>
    		<button onClick={() => setTheme("dark")}>다크</button>
    		<button onClick={() => setTheme("system")}>시스템</button>
    	</div>
    );

}`}
/>

---

## Theme 타입

<Source language="tsx" code={`type Theme = "light" | "dark" | "system";`} />

| 값         | 동작                                                  |
| ---------- | ----------------------------------------------------- |
| `"light"`  | 라이트 모드 강제, `localStorage`에 저장               |
| `"dark"`   | 다크 모드 강제, `localStorage`에 저장                 |
| `"system"` | OS 설정(`prefers-color-scheme`)을 따름, 저장하지 않음 |

---

## API

### ThemeProvider

<Source
	language="tsx"
	code={`<ThemeProvider>
	{children}
</ThemeProvider>`}
/>

| Prop       | 타입        | 설명               |
| ---------- | ----------- | ------------------ |
| `children` | `ReactNode` | 자식 컴포넌트 트리 |

**동작 방식:**

- 마운트 시 `localStorage`에 저장된 테마를 복원하고, 없으면 시스템 설정을 따릅니다.
- `document.documentElement`에 `data-theme`과 `colorScheme`을 설정합니다.
- `"system"` 모드일 때는 `localStorage`에 저장하지 않습니다.

### useTheme

<Source language="tsx" code={`const { theme, setTheme } = useTheme();`} />

| 반환값     | 타입                     | 설명           |
| ---------- | ------------------------ | -------------- |
| `theme`    | `Theme`                  | 현재 테마 값   |
| `setTheme` | `(theme: Theme) => void` | 테마 변경 함수 |

> `ThemeProvider` 외부에서 `useTheme`을 호출하면 에러가 발생합니다.

---

## ThemeToggle 컴포넌트

별도의 구현 없이 내장 `ThemeToggle` 컴포넌트를 사용할 수도 있습니다.

<Source
	language="tsx"
	code={`import { ThemeProvider, ThemeToggle } from "@kim-yeo/ui";

function App() {
return (

<ThemeProvider>
<header>
<ThemeToggle />
</header>
<main>{/* ... */}</main>
</ThemeProvider>
);
}`}
/>

---

## 테마 유틸리티 함수

직접 테마 상태를 제어해야 할 때 사용하는 저수준 유틸리티입니다.

<Source
	language="tsx"
	code={`import {
	getStoredTheme,
	setStoredTheme,
	getSystemTheme,
	getResolvedTheme,
	type Theme,
} from "@kim-yeo/ui";`}
/>

| 함수               | 반환 타입           | 설명                                            |
| ------------------ | ------------------- | ----------------------------------------------- |
| `getStoredTheme`   | `Theme \| null`     | `localStorage`에서 저장된 테마 값을 읽음        |
| `setStoredTheme`   | `void`              | `localStorage`에 테마 값을 저장                 |
| `getSystemTheme`   | `"light" \| "dark"` | OS의 `prefers-color-scheme` 설정을 반환         |
| `getResolvedTheme` | `"light" \| "dark"` | 저장된 테마 → 시스템 테마 순으로 최종 테마 결정 |
